{
  "$schema": "http://json-schema.org/draft-04/schema#",
    
  "type":"object",

  "definitions": {
    "basic_attribute_type": {
      "type": "string",
      "enum":["string","text","markup","integer","boolean","product","category","file"]
    },
    "enumerated_attribute_type": {
      "type": "string",
      "enum":["enum"]
    },
    "custom_attribute_type": {
      "type": "string",
      "pattern": "^custom\\.\\w+$"
    },
   "attribute_base": {
     "properties": {
       "id": {"$ref":"common.json#/definitions/id"},
       "name": {"$ref":"common.json#/definitions/name"},
       "description": {"$ref":"common.json#/definitions/description"},
       "type": {
         "oneOf":[{
           "$ref": "#/definitions/basic_attribute_type"},{
           "$ref": "#/definitions/enumerated_attribute_type"},{
           "$ref": "#/definitions/custom_attribute_type"
       }]},
       "values":{},
       "required": {"type": "boolean","default": true},
       "default_value":{
         "oneOf":[{
           "type":"string"},{
           "type":"integer"},{
           "type":"boolean"
         }]
       }
     },
     "required": ["id","type"],
     "additionalProperties":false
   },
   "basic_attribute": {
     "allOf": [
       { "$ref": "#/definitions/attribute_base" },
       { "properties": {
           "type": { "$ref": "#/definitions/basic_attribute_type" },
           "values":{"not":{}}
         },
         "required": ["type"]
       }
     ]
   },
   "enumerated_attribute": {
     "allOf": [
       { "$ref": "#/definitions/attribute_base" },
       { "properties": {
           "type": { "$ref": "#/definitions/enumerated_attribute_type" },
           "values": {
             "oneOf":[{
               "type": "array", "minItems":1, "items": {"type": "string"}},{
               "type": "array", "minItems":1, "items": {"type": "integer"}
             }]
           }
         },
         "required": ["type", "values"]
       }
     ]
   },
   "custom_attribute": {
     "allOf": [
       { "$ref": "#/definitions/attribute_base" },
       { "properties": {
           "type": { "$ref": "#/definitions/custom_attribute_type" },
           "values":{"not":{}}
         },
         "required": ["type"]
       }
     ]
   }
  },
  
  "oneOf": [
    { "$ref": "#/definitions/basic_attribute" },
    { "$ref": "#/definitions/enumerated_attribute" },
    { "$ref": "#/definitions/custom_attribute" }
  ]
}